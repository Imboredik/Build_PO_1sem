# DrinkManager
## Состав команды: 
1. 	Смирнов Даниил Сергеевич	5130904/30105
2.  Ефимов Владислав Андреевич	5130904/30105

# Определение проблемы: 
Клиенты баров, которые иногда могут не знать какой напиток выбрать, это может быть связано, как и первым посищением таких заведений, так и с желанием попробовать что-то новое, нет такого ешения, где они могут получить:

1. Случайные коктейли
2. Наглядное представление ингредиентов
3. Инструкции по приготовлению
4. Фотографии коктейлей

# Выработка требований:
Для выработки требований к проекту были разработаны пользовательские сценарии
**Сценарий 1: Получение случайного коктейля**  
Как клиент бара, я хочу быстро узнать какие есть коктейли, которые можно заказать, но при этом не расспрашивая бармена о информации по коктейлям.

**Сценарий 2: Получение случайного рецепта**  
Как начинающий бармен, я хочу научиться готовить новые различные коктейли, но не знаю где можно подобрать случайный коктейл.

# Разработка архитектуры и детальное проектирование

**Ожидаемое число пользователей:** 5,000 активных пользователей в месяц
**Период хранения данных:** 1 год
**Пиковая нагрузка:** вечерние часы и выходные дни

## Характер нагрузки на сервис
Соотношение R/W нагрузки:

Чтение (R): 90% (получение рецептов коктейлей, проверка пользователей)

Запись (W): 10% (регистрация новых пользователей, обновление информации)

## Объемы трафика
Средний размер запроса: 1 KB

Средний размер ответа: 200 KB (включая фото напитка и данные API)

Ожидаемый трафик: 20 GB/месяц

RPS (запросов в секунду): ~20 в пиковые часы

# Диаграммы C4 Model
## Контекст
<img  alt="image" src="https://github.com/Imboredik/Build_PO_1sem/blob/main/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%D1%88%D0%BE%D1%82%2009-02-2026%20152230.jpg" />

# Контракты API
Информация о контрактах доступна по ссылке https://www.thecocktaildb.com/api.php


# Нефункциональные требования на время отклика
Производительность:

Получение рецепта коктейля: 95-й перцентиль (p95) < 2 секунды

Обработка команды /start: 95-й перцентиль (p95) < 500 мс

Ответ на команду пользователя: < 3 секунды

Обоснование:

2 секунды для получения рецепта: Учитывает время запроса к внешнему API и обработку данных

500 мс для /start: Простая текстовая команда без внешних запросов

3 секунды максимальное время: Пользователи Telegram ожидают быстрого ответа от ботов

# Базы данных
<img alt="image" src="https://github.com/Imboredik/Build_PO_1sem/blob/main/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%D1%88%D0%BE%D1%82%2009-02-2026%20145459.jpg" />

## Обеспечение нефункциональных требований БД

Производительность:

PostgreSQL выдержит нагрузку от 5,000 пользователей благодаря:

Простой схеме (1 таблица)

Индексу на telegram_user_id для быстрого поиска

Минимальному объему данных

Ожидаемые показатели:

Поиск пользователя: < 50 мс для 95% запросов

Добавление пользователя: < 100 мс для 95% запросов

Масштабируемость:

Пиковая нагрузка ~20 запросов в секунду легко обрабатывается

При росте нагрузки можно оптимизировать запросы и добавить кэширование

Надежность:

SSH туннель обеспечивает безопасное подключение

Простая структура данных минимизирует риски

## Схема масштабирования сервиса

При увеличении количества пользователей в 10 раз могут быть внедрены следующие технологии:
Кэширование запросов - Кэширование рецептов коктейлей для уменьшения запросов к внешнему API
Балансировка нагрузки - Запуск нескольких инстансов бота при высокой нагрузке
Оптимизация запросов к БД - Добавление индексов и оптимизация запросов
Мониторинг - Отслеживание времени ответа и ошибок
Асинхронная обработка - Улучшение обработки параллельных запросов

# Кодирование и отладка

## Стек используемых технологий:

### Backend
Python - основной язык программирования
python-telegram-bot - фреймворк для создания Telegram ботов
SQLAlchemy - ORM для работы с базой данных
PostgreSQL - реляционная база данных
SQLAlchemy - работа с базой данных
SSHTunnel - создание SSH туннелей для безопасного подключения
python-dotenv - управление переменными окружения
Requests - HTTP запросы к внешним API

### Инфраструктура и инструменты
Docker - контейнеризация приложения (планируется)
Docker-compose - акестрация контейнеров
PostgreSQL - основное хранилище данных
Git - система контроля версий
pytest - фреймворк для unit-тестирования
unittest.mock - мокирование для тестирования

## Тестирование
test_api.py - тестирование модуля работы с внешним API
test_handlers.py - тестирование обработчиков команд бота

pytest test_api.py
pytest test_handlers.py

## Сборка
Для сборки и запуска проекта выполните:

Создайте .env файл с нужными параметрами

docker-compose up --build -d

Остановка:
docker-compose down


